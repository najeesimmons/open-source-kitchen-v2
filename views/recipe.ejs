<!DOCTYPE html>
<html lang="en" class="has-navbar-fixed-top">
  <%- include ('./partials/head.ejs', {page: 'Recipe Blog' }) %> <%- include
  ('./partials/nav.ejs') %>

  <body>
    <h1 class="recipe-heading recipe-heading-show"><%= foundRecipe.title %> <span class="user-tag">by <%= foundRecipe.user %></span></h1>
    
    <div class="recipe-show-image-container">
      <img src="<%= foundRecipe.image %>" class="recipe-show-image" />
    </div>

    <p class="recipe-show-description"><%= foundRecipe.description %></p>
    
    <div>
      <div>
        <h3 class="gen-heading">Ingredients:</h3>
        <ul>
          <% for(let idx=0; idx < foundRecipe.ingredients.length; idx++){ %>
          <li><%= foundRecipe.ingredients[idx]%></li>
          <%}%>
        </ul>
      </div>
      <div>
        <h3 class="gen-heading">Preperation:</h3>
        <ul>
          <% for(let idx=0; idx < foundRecipe.recipe.length; idx++){ %>
          <li><%= foundRecipe.recipe[idx]%></li>
          <%}%>
        </ul>
      </div>
    </div>

    <div class="buttons-box">
      <button class="button-style edit-button">
        <a href="/recipeblog/<%= foundRecipe.title%>/edit">Edit</a>
      </button>
      <form
        action="/recipeblog/<%= foundRecipe.title%>?_method=DELETE"
        method="POST"
      >
        <button class="button-style delete-button">Delete</button>
      </form>
    </div>
    <hr />
    <div>
      <form action="/recipeblog/<%= foundRecipe.title %>" method="POST">
        <fieldset>
          <legend class="sub-heading">Have you cooked this recipe?</legend>
          <span class="weak-heading"
            >Leave a review and let us know what you think!</span
          >
          <input type="hidden" name="recipe" value=" <%= foundRecipe._id %> " />
          <div>
            <label for="text">User</label>
            <input name="user" type="text" id="text" placeholder="Your name" />
          </div>
          <div>
            <label for="text">Headline</label>
            <input name="title" type="text" id="text" />
          </div>
          <div>
            <label for="text">Rating</label>
            <input name="rating" type="number" id="number" placeholder="1-5" />
          </div>
          <div>
            <label for="text">Comment</label>
            <input name="comment" type="text" id="text" />
          </div>
          <input type="hidden" name="_id" value="" ="foundRecipe._id" /> >
          <button type="submit">Submit</button>
        </fieldset>
      </form>
    </div>
    <h1 class="weak-heading">User Reviews</h1>
    <div>
      <% for (let i = 0; i < foundRecipe.review.length; i++) { %>
      <div>
        <% if (foundRecipe.review.length < 1) { %> <%
        console.log(foundRecipe.review.length)%>
        <h3>No Reviews Yet.</h3>
        <% } else { %>
        <div>Rating: <%= foundRecipe.review[i].rating %></div>
        <div>User: <%= foundRecipe.review[i].user %></div>
        <div>Headline: <%= foundRecipe.review[i].title %></div>
        <div>Comment: <%= foundRecipe.review[i].comment %></div>
      </div>
      <% } %> <% } %>
    </div>
  </body>
</html>
